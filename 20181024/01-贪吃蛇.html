<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<script type="text/javascript">
			//åœ°å›¾ç±»
			(function(){
				//åœ°å›¾çš„æ„é€ å‡½æ•°
				//åœ°å›¾çš„å®½,é«˜,èƒŒæ™¯è‰²
				function MapS(width,height,bgColor){
					this.width = width;
					this.height = height;
					this.bgColor = bgColor;
				}
			
				//Mapçš„åŸå‹å¯¹è±¡,å…¬å…±ç©ºé—´,ç”±æ¥åˆå§‹åŒ–åˆ›å»ºåœ°å›¾divå…ƒç´ å¯¹è±¡
				MapS.prototype.init  = function(){
					//åˆ›å»ºåœ°å›¾divå…ƒç´ 
					var divMap = document.createElement('div');
					//è®¾ç½®div csså±æ€§
					divMap.style.width = this.width +'px';
					divMap.style.height = this.height +'px';
					divMap.style.backgroundColor = this.bgColor;
//					//idå
					divMap.id = 'divMap';
					//ç›¸å¯¹å®šä½
					divMap.style.position = 'relative';
					//æ·»åŠ åˆ°bodyä¸­
					document.body.appendChild(divMap);
				}
				//ç”±äºè‡ªè°ƒç”¨å‡½æ•°ä¹Ÿæ˜¯å‡½æ•°,å…·å¤‡å‡½æ•°ä½œç”¨åŸŸçš„æ„Ÿå¿µ,
				//æ‰€ä»¥æ­¤æ—¶ä»å¤–ç•Œæ˜¯æ— æ³•è®¿é—®å‡½æ•°å†…éƒ¨çš„ç§æœ‰å˜é‡å’Œæ–¹æ³•çš„
				//å¯ä»¥æŠŠå‡½æ•°ä¸­æƒ³è¦å…¬å¸ƒå‡ºå»çš„å±æ€§å’Œæ–¹æ³•æ·»åŠ åˆ°windowå¯¹è±¡ä¸Š,
				//å› ä¸ºwindowå¯¹è±¡æ˜¯æµè§ˆå™¨çš„é¡¶çº§å¯¹è±¡,æ‰€æœ‰ä½ç½®éƒ½å¯ä»¥æ–¹ä½åˆ°å®ƒ
				window.MapS = MapS;
			}());
			
			//é£Ÿç‰©ç±»
			(function(){
				//é£Ÿç‰©çš„æ„é€ å‡½æ•°
				function Food(width,height,bgColor){
					this.width = width;
					this.height = height;
					this.bgColor = bgColor;
					this.x = 0;//æ¨ªåæ ‡
					this.y = 0;//çºµåæ ‡
				}
				Food.prototype.init = function(){
					//åˆ›å»ºé£Ÿç‰©divå…ƒç´ å¯¹è±¡
					var divFood = document.createElement('div');
					//è®¾ç½®div csså±æ€§
					divFood.style.width = this.width +'px';
					divFood.style.height = this.height +'px';
					divFood.style.backgroundColor = this.bgColor;
					
					//è·å–åœ°å›¾divå…ƒç´ 
					var divMap = document.getElementById('divMap');
					console.log(divMap);
//					console.log(divMap.offsetWidth);
					//é£Ÿç‰©çš„åæ ‡,ç§»åŠ¨æˆ–éšæœºç”Ÿæˆçš„,xyçš„æ ¼æ•°
					                       //800/20 = 40(æ ¼)
					//æ ¼æ•°çš„ç®—æ³•: æ¨ªåæ ‡  :  åœ°å›¾çš„å®½åº¦/é£Ÿç‰©çš„å®½åº¦ = æ ¼æ•°
					//éšæœºç”Ÿæˆä¸€ä¸ª0-40
					//leftçš„æ ¼æ•°
					this.x = parseInt(Math.random()*(divMap.offserWidth/this.width));
					//topçš„æ ¼æ•°
					this.y = parseInt(Math.random()*(divMap.offsetHeight/this.height));
					divFood.style.position = 'absolute';
					divFood.style.left=this.x * this.width + 'px';
					divFood.style.top=this.y * this.height + 'px';
					//æ·»åŠ åˆ°åœ°å›¾mapå¯¹è±¡çš„å­å…ƒç´ ä¸Š
					divMap.appendChild(divFood);
				}
				//å°†é£Ÿç‰©æ„é€ å‡½æ•°å…¬å¸ƒåˆ°windowå±æ€§ä¸Š
				window.Food = Food;
			}());
			
			//è›‡ç±»
			(function(){
				//åˆ›å»ºæ•°ç»„,å­˜è›‡æ–­
				var elements = [];
				//è›‡æ„é€ å‡½æ•°
				function Snake(width,height,dir){
					//è›‡æ¯æ®µçš„å®½åº¦
					this.width = width;
					//è›‡ğŸæ¯æ®µçš„é«˜åº¦
					this.height = height;
					//è›‡çš„é»˜è®¤æ–¹å‘
					this.dir = dir;
					//è›‡èº«çš„ä¸‰éƒ¨åˆ†çš„åæ ‡å€¼å’ŒèƒŒæ™¯è‰²
					this.snBody = [{
						x:3,
						y:2,
						bgColor:'red'
					},{
						x:2,
						y:2,
						bgColor:'orange'
					},{
						x:1,
						y:2,
						bgColor:'orange'
					}];
				}
				Snake.prototype.init = function(){
					//åˆ é™¤è€è›‡
					remove();
					//æ ¹æ®è›‡æ•°ç»„ä¸­çš„å…ƒç´ çš„ä¸ªæ•°æ¥åˆ›å»ºdivçš„ä¸ªæ•°
					for(var i = 0;i<this.snBody.length;i++){
						
						//åˆ†åˆ«åˆ›å»ºä¸‰ä¸ªdiv(è›‡èº«)
						var snakeDiv = document.createElement('div');
						//è®¾ç½®æ¯æ®µçš„div çš„csså±æ€§
						snakeDiv.style.width = this.width + 'px';
						snakeDiv.style.height = this.height +'px';
						snakeDiv.style.position = 'absolute';
						snakeDiv.style.left = this.snBody[i].x*this.width+'px';
						snakeDiv.style.top = this.snBody[i].y*this.height+'px';
						snakeDiv.style.background = this.snBody[i].bgColor;
						
						//æ·»åŠ åˆ°mapåœ°å›¾å…ƒç´ å¯¹è±¡ä¸­
						//è·å–åœ°å›¾divå…ƒç´ 
						var divMap = document.getElementById('divMap');
						//æ·»åŠ åˆ°domæ ‘ä¸Š
						divMap.appendChild(snakeDiv);
						//å­˜å‚¨åˆ°æ•°ç»„ä¸­
						elements.push(snakeDiv);
					}
					console.log(elements);
				}
				//åˆ é™¤domä¸­çš„divå¯¹è±¡,æ•°ç»„ä¸­çš„divå¯¹è±¡
				function remove(){
					for(var i = 0;i<elements.length;i++){
						//ä»mapä¸­æŠŠè›‡æ–­çš„divå…ƒç´ åˆ é™¤
						elements[i].parentElement.removeChild(elements[i]);
						//åˆ é™¤æ•°ç»„ä¸­çš„å…ƒç´ 
						elements.splice(i,1);
					}
				}
				window.Snake = Snake;
			}());
				Snake.prototype.move = function(){
					for (var i = this.snBody.length-1; i>0; i--) {
						this.snBody[i].x = this.snBody[i-1].x;
						this.snBody[i].y = this.snBody[i-1].y;
					}
					this.snBody[0].x +=1;
					console.log(this.snBody);
				}
			
			
			//åˆ›å»ºåœ°å›¾å¯¹è±¡
			var mapS = new MapS(800,600,'#ccc');
			//è°ƒç”¨å¯¹è±¡çš„initæ–¹æ³•,åˆ›å»ºåœ°å›¾divå…ƒç´ 
			mapS.init();
//			console.log(mapS);
			//åˆ›å»ºé£Ÿç‰©å¯¹è±¡
			var food = new Food(20,20,'green');
			food.init();
			//åˆ›å»ºè›‡å¯¹è±¡
			var snake = new Snake(20,20,'right');
			setInterval(function(){
				snake.init();
				snake.move();
			},300);
			
		</script>
	</body>
</html>
